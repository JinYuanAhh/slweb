var ue=Object.defineProperty;var re=(a,e,o)=>e in a?ue(a,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[e]=o;var M=(a,e,o)=>(re(a,typeof e!="symbol"?e+"":e,o),o);import{d as b,r as k,i as w,a as F,o as f,c as y,w as n,b as s,u as c,e as H,p as Q,f as X,g as p,E as Y,h as Z,j as ee,k as x,l as te,m as B,n as g,q as G,s as J,t as ce,v as R,x as ie,y as de,z as _e,A as pe,B as ge,C as me,D as N,F as E,G as se,H as S,I as j,J as q,K as oe,L as fe,M as T,N as ne,O as Ce,P as Se,Q as ve,R as he,S as Ie,T as ye,U as Ae,V as Ee,W as K}from"./vendor.cb27f377.js";const we=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&l(d)}).observe(document,{childList:!0,subtree:!0});function o(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerpolicy&&(r.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?r.credentials="include":t.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(t){if(t.ep)return;t.ep=!0;const r=o(t);fetch(t.href,r)}};we();var V=(a,e)=>{const o=a.__vccOpts||a;for(const[l,t]of e)o[l]=t;return o};const z=a=>(Q("data-v-45ab1e60"),a=a(),X(),a),be=z(()=>p("span",null,"\u8D26\u6237",-1)),De=z(()=>p("span",null,"\u804A\u5929",-1)),Me=z(()=>p("span",null,"DEBUG",-1)),Be=b({setup(a){let e=k(location.hash.split("/")[1]),o=w("SIM");return(l,t)=>{const r=F("user"),d=Y,i=Z,m=F("chat-line-square"),u=ee;return f(),y(u,{router:"","default-active":c(e),class:"SideMenu"},{default:n(()=>[s(i,{index:"account"},{default:n(()=>[s(d,null,{default:n(()=>[s(r)]),_:1}),be]),_:1}),c(o).ACI.logged?(f(),y(i,{key:0,index:"chat"},{default:n(()=>[s(d,null,{default:n(()=>[s(m)]),_:1}),De]),_:1})):H("",!0),s(i,{index:"DEBUG"},{default:n(()=>[s(d,null,{default:n(()=>[s(m)]),_:1}),Me]),_:1})]),_:1},8,["default-active"])}}});var Te=V(Be,[["__scopeId","data-v-45ab1e60"]]);class ke{constructor(e){M(this,"ws");M(this,"ACI");M(this,"UInfo");M(this,"l_vars");this.ws=new WebSocket(e),this.ACI=x({AC:"",T:localStorage.getItem("autoSignin")=="true"?localStorage.getItem("T")!=null?localStorage.getItem("T"):"":sessionStorage.getItem("T")!=null?sessionStorage.getItem("T"):"",logged:!1}),this.UInfo={},this.l_vars={}}ValidJSON(e){if(typeof e=="string")try{var o=JSON.parse(e);if(typeof o=="object"&&o)return!0}catch{}return!1}Connect(e){this.ws!=null&&this.ws.close(),this.ws=new WebSocket(e),this.ACI.AC="",this.ACI.T=""}SetACI(e,o){this.ACI.AC=e,this.ACI.T=o}HandleOpen(e){this.ws.onopen=e}HandleMessage(e){this.ws.onmessage=e}HandleError(e){this.ws.onmessage=e}HandleClose(e){this.ws.onclose=e}Signin(e,o){let l={Type:"Signin",Info:{Account:e,Pwd:o}};this.l_vars.account=e,this.ws.send(JSON.stringify(l))}Signup(e,o){let l={Type:"Signup",Info:{Account:e,Pwd:o}};this.ws.send(JSON.stringify(l))}Reconnect(){let e={Type:"Reconnect",T:this.ACI.T};this.ws.send(JSON.stringify(e))}Message(e,o,l){let t={Type:"SendMsg",Info:{Content:o,T:l,Type:e},T:this.ACI.T};this.ws.send(JSON.stringify(t))}Logout(){let e={Type:"Logout",T:this.ACI.T};this.ws.send(JSON.stringify(e)),sessionStorage.clear(),localStorage.clear(),this.ACI.AC="",this.ACI.T="",this.ACI.logged=!1}}var ae={serverUrl:"127.0.0.1:8889"},P={AddCurrentMessage(a,e,o){a.push({from:{avatar:e.Avatar,nickname:e.Nickname,account:e.Account},content:o})},GetHistroyPublicMessages(a){te.get("http://"+ae.serverUrl+"/api/query/historyPublicMessages").then(e=>{e.data.forEach(o=>{a.push(o)})})}};const Fe=b({setup(a){let e=!0,o=!1,l=k(location.hash.split("/")[1]);B("fullscreenLoading",e),B("pageViewLoading",o),B("SideMenuActive",l.value);const t=new ke("ws://"+ae.serverUrl+"/ws");B("SIM",t);let r=x([]);if(B("CurrentMessages",r),t.HandleOpen(()=>{g({message:"\u8FDE\u63A5\u670D\u52A1\u5668\u6210\u529F",type:"success",duration:1e3})}),t.HandleClose(()=>{g({message:"\u4E0E\u670D\u52A1\u5668\u7684\u8FDE\u63A5\u5173\u95ED",type:"warning",duration:1e3})}),t.HandleError(d=>{g({message:"\u8FDE\u63A5\u670D\u52A1\u5668\u9519\u8BEF",type:"error",duration:1e3}),console.log(d)}),t.HandleMessage(d=>{if(!t.ValidJSON(d.data))return;let i=JSON.parse(d.data);switch(console.log(i),i.Type){case"Signin":switch(i.Status){case"Success":t.ACI.T=i.T,localStorage.getItem("autoSignin")=="true"?localStorage.setItem("T",i.T):sessionStorage.setItem("T",i.T),t.ACI.AC=t.l_vars.account,t.ACI.logged=!0,g({message:"\u767B\u5165\u6210\u529F",type:"success"}),P.GetHistroyPublicMessages(r);break;case"Error":switch(i.Err){case"user doesn't exists":g({message:"\u767B\u5165\u5931\u8D25 -> \u8D26\u53F7\u4E0D\u5B58\u5728",type:"error"});break;case"password is wrong":g({message:"\u767B\u5165\u5931\u8D25 -> \u5BC6\u7801\u9519\u8BEF",type:"error"});break;case"account has been logged":g({message:"\u767B\u5165\u5931\u8D25 -> \u6B64\u8D26\u53F7\u5DF2\u5728\u7F51\u9875\u7248\u767B\u5F55",type:"error"});break}break}break;case"Message":switch(i.Info.Type){case"Public":switch(i.Info.ContentType){case"Text":P.AddCurrentMessage(r,i.Info.From,i.Info.Content)}break}break;case"Signup":switch(i.Status){case"Success":g({message:"\u6CE8\u518C\u6210\u529F",type:"success"});break;case"Error":switch(i.Err){case"account contains illegal character":g({message:"\u6CE8\u518C\u5931\u8D25 -> \u8D26\u53F7\u5305\u542B\u6709\u975E\u6CD5\u5B57\u7B26",type:"error"});break;case"pwd contains illegal character":g({message:"\u6CE8\u518C\u5931\u8D25 -> \u5BC6\u7801\u5305\u542B\u6709\u975E\u6CD5\u5B57\u7B26",type:"error"});break;case"account exists":g({message:"\u6CE8\u518C\u5931\u8D25 -> \u6B64\u8D26\u53F7\u5DF2\u5B58\u5728",type:"error"});break}}break;default:break;case"Reconnect":i.Status=="Success"?(g({message:"\u91CD\u8FDE\u6210\u529F",type:"success"}),P.GetHistroyPublicMessages(r),t.ACI.logged=t.l_vars.logged):g({message:"\u91CD\u8FDE\u5931\u8D25",type:"error"})}}),t.ACI.logged=!1,localStorage.getItem("autoSignin")=="true"&&localStorage.getItem("AC")&&localStorage.getItem("T")?(t.ACI.T=localStorage.getItem("T"),t.ACI.AC=localStorage.getItem("AC"),g("\u6B22\u8FCE"+localStorage.getItem("AC")),t.l_vars.logged=!0):sessionStorage.getItem("T")&&sessionStorage.getItem("AC")&&(t.ACI.T=sessionStorage.getItem("T"),t.ACI.AC=sessionStorage.getItem("AC"),t.l_vars.logged=!0),t.l_vars.logged){let d=setInterval(function(){t.ws.readyState==1&&(clearInterval(d),t.Reconnect())},100)}return e=!1,(d,i)=>{const m=G,u=F("router-view"),v=J,h=ce;return R((f(),y(v,{class:"MContainer",gutter:40},{default:n(()=>[s(m,{span:3},{default:n(()=>[s(Te)]),_:1}),s(m,{span:21},{default:n(()=>[R(s(u,null,null,512),[[h,c(o)]])]),_:1})]),_:1})),[[h,c(e),void 0,{fullscreen:!0,lock:!0}]])}}}),xe=S("\u767B\u5165"),Ve=S("\u6CE8\u518C"),Ue=S("\u767B\u5165"),Ne=S("\u6CE8\u518C"),$e=b({setup(a){const e=x({account:"",password:"",autoSignin:localStorage.getItem("autoSignin")=="true"}),o=x({account:"",password:""});let l=k(!1),t=k(!1),r=w("SIM");const d=()=>{localStorage.setItem("autoSignin",e.autoSignin.toString()),e.autoSignin?localStorage.setItem("AC",e.account):sessionStorage.setItem("AC",e.account),r.Signin(e.account,j(e.password).toString()),r.ACI.T!=""&&(l=!1)},i=()=>{r.Signup(o.account,j(o.password).toString())};return(m,u)=>{const v=q,h=oe,O=ie,A=de,C=_e,L=pe,U=ge,D=me;return f(),N(se,null,[s(v,{style:{"margin-top":"20px"},size:"large",type:"default",onClick:u[0]||(u[0]=_=>E(l)?l.value=!0:l=!0)},{default:n(()=>[xe]),_:1}),s(v,{style:{"margin-top":"20px"},size:"large",type:"default",onClick:u[1]||(u[1]=_=>E(t)?t.value=!0:t=!0)},{default:n(()=>[Ve]),_:1}),s(h),s(O,{title:"\u767B\u5165\u4EE5\u663E\u793A\u5185\u5BB9",type:"info"}),s(D,{center:"",title:"\u767B\u5165",modelValue:c(l),"onUpdate:modelValue":u[6]||(u[6]=_=>E(l)?l.value=_:l=_),width:"30%"},{default:n(()=>[s(U,{ref:"SigninConfigRef",model:c(e),"label-position":"right"},{default:n(()=>[s(C,{label:"\u8D26\u53F7"},{default:n(()=>[s(A,{modelValue:c(e).account,"onUpdate:modelValue":u[2]||(u[2]=_=>c(e).account=_)},null,8,["modelValue"])]),_:1}),s(C,{label:"\u5BC6\u7801"},{default:n(()=>[s(A,{modelValue:c(e).password,"onUpdate:modelValue":u[3]||(u[3]=_=>c(e).password=_),type:"password"},null,8,["modelValue"])]),_:1}),s(C,{label:"\u81EA\u52A8\u767B\u5165(\u76F4\u5230\u6CE8\u9500\u6216120\u5929)"},{default:n(()=>[s(L,{modelValue:c(e).autoSignin,"onUpdate:modelValue":u[4]||(u[4]=_=>c(e).autoSignin=_)},null,8,["modelValue"])]),_:1}),s(C,null,{default:n(()=>[s(v,{size:"large",type:"primary",onClick:u[5]||(u[5]=_=>{d(),E(l)?l.value=!1:l=!1})},{default:n(()=>[Ue]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),s(D,{center:"",title:"\u6CE8\u518C",modelValue:c(t),"onUpdate:modelValue":u[10]||(u[10]=_=>E(t)?t.value=_:t=_),width:"30%"},{default:n(()=>[s(U,{ref:"SignupConfigRef",model:c(o),"label-position":"right"},{default:n(()=>[s(C,{label:"\u8D26\u53F7"},{default:n(()=>[s(A,{modelValue:c(o).account,"onUpdate:modelValue":u[7]||(u[7]=_=>c(o).account=_)},null,8,["modelValue"])]),_:1}),s(C,{label:"\u5BC6\u7801"},{default:n(()=>[s(A,{modelValue:c(o).password,"onUpdate:modelValue":u[8]||(u[8]=_=>c(o).password=_),type:"password"},null,8,["modelValue"])]),_:1}),s(C,null,{default:n(()=>[s(v,{size:"large",type:"primary",onClick:u[9]||(u[9]=_=>{i(),E(t)?t.value=!1:t=!1})},{default:n(()=>[Ne]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}});const Oe={class:"card-header"},Le=S("\u767B\u51FA"),Pe=b({setup(a){let e=w("SIM"),o=x({Nickname:"",Avatar:""}),l=w("CurrentMessages");return e.ACI.AC!=""&&te.post("http://127.0.0.1:8889/api/query/userPublicInfo",{account:e.ACI.AC}).then(t=>{console.log("publicInfo",t.data),o.Nickname=t.data.Nickname,o.Avatar=t.data.Avatar}),(t,r)=>{const d=fe,i=q,m=ne;return f(),y(m,null,{header:n(()=>[p("div",Oe,[s(d,{src:c(o).Avatar},null,8,["src"]),p("span",null,T(c(o).Nickname),1),s(i,{onClick:r[0]||(r[0]=u=>(c(e).Logout(),c(l).length=0)),class:"button",type:"text"},{default:n(()=>[Le]),_:1})])]),default:n(()=>[p("span",null,"\u8D26\u53F7\uFF1A "+T(c(e).ACI.AC),1)]),_:1})}}});var He=V(Pe,[["__scopeId","data-v-19d75bc6"]]);const Re={class:"UContainer"},Ge=b({setup(a){let e=w("SIM");return(o,l)=>{const t=G,r=J;return f(),N("div",Re,[c(e).ACI.logged?H("",!0):(f(),y($e,{key:0})),c(e).ACI.logged?(f(),y(r,{key:1,class:"Container"},{default:n(()=>[s(t,{span:6},{default:n(()=>[s(He)]),_:1})]),_:1})):H("",!0)])}}});var Je=V(Ge,[["__scopeId","data-v-6a84cc67"]]);const $=a=>(Q("data-v-75fd7d59"),a=a(),X(),a),qe=$(()=>p("span",null,"\u7FA4",-1)),ze=S(" PublicRoom "),We=$(()=>p("span",null,"\u597D\u53CB",-1)),je=$(()=>p("span",null,"\u81EA\u6211",-1)),Ke={class:"messages"},Qe={class:"info"},Xe=S(),Ye=$(()=>p("br",null,null,-1)),Ze=S(),et={class:"avatar"},tt=["src"],st={class:"content"},ot=S("\u53D1\u9001"),nt=b({setup(a){let e=w("SIM"),o=k(""),l=()=>{if(o.value==""){g("\u4E0D\u80FD\u53D1\u9001\u7A7A\u5185\u5BB9");return}e.Message("Public",o.value),o.value=""},t=w("CurrentMessages");return(r,d)=>{const i=F("position"),m=Y,u=F("house"),v=Z,h=Ce,O=ee,A=Se,C=G,L=ve,U=oe,D=J,_=q,le=ne;return f(),y(le,{class:"CContainer"},{default:n(()=>[s(D,null,{default:n(()=>[s(C,{span:4},{default:n(()=>[s(A,null,{default:n(()=>[s(O,{"default-active":"Groups-#PublicRoom",class:"FriendsList"},{default:n(()=>[s(h,{index:"Groups"},{title:n(()=>[s(m,null,{default:n(()=>[s(i)]),_:1}),qe]),default:n(()=>[s(v,{index:"Groups-#PublicRoom"},{default:n(()=>[s(m,null,{default:n(()=>[s(u)]),_:1}),ze]),_:1})]),_:1}),s(h,{index:"Friends"},{title:n(()=>[s(m,null,{default:n(()=>[s(i)]),_:1}),We]),_:1}),s(h,{index:"Self"},{title:n(()=>[s(m,null,{default:n(()=>[s(i)]),_:1}),je]),_:1})]),_:1})]),_:1})]),_:1}),s(C,{span:20},{default:n(()=>[s(A,{style:{"max-height":"75%",padding:"10px"}},{default:n(()=>[p("div",Ke,[(f(!0),N(se,null,he(c(t),I=>(f(),y(D,{key:I,class:"message",justify:"start"},{default:n(()=>[p("div",Qe,[s(L,null,{content:n(()=>[p("span",null,T(I.from.nickname),1),Xe,Ye,Ze,p("span",null,"\u8D26\u53F7:"+T(I.from.account),1)]),default:n(()=>[p("div",et,[p("img",{src:I.from.avatar},null,8,tt)])]),_:2},1024)]),s(U,{direction:"vertical"}),p("div",st,[p("span",null,T(I.content),1)])]),_:2},1024))),128))])]),_:1}),R(p("textarea",{"onUpdate:modelValue":d[0]||(d[0]=I=>E(o)?o.value=I:o=I),class:"SendMsgInput",name:"",id:""},null,512),[[Ie,c(o)]]),s(_,{onClick:c(l),type:"primary",class:"sendBtn"},{default:n(()=>[ot]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})}}});var at=V(nt,[["__scopeId","data-v-75fd7d59"]]);const lt={},ut=p("code",{class:"language-css"},"p {color: #444;}",-1),rt=[ut];function ct(a,e){return f(),N("pre",null,rt)}var it=V(lt,[["render",ct]]);const dt=[{path:"/",redirect:"/account"},{path:"/account",component:Je},{path:"/chat",component:at},{path:"/DEBUG",component:it}],_t=ye({history:Ae(),routes:dt}),W=Ee(Fe);for(const a in K)W.component(a,K[a]);W.use(_t);W.mount("#app");
